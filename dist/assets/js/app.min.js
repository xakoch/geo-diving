let lozadObserver;function initLozad(){try{"undefined"==typeof lozad?console.warn("Lozad не найден"):(lozadObserver=lozadObserver&&null,(lozadObserver=lozad(".lozad",{threshold:.01,rootMargin:"50px",enableAutoReload:!0})).observe(),setTimeout(()=>{document.querySelectorAll('.lozad[data-background-image]:not([data-loaded="true"])').forEach(e=>{var t=e.getBoundingClientRect(),n=window.innerHeight;t.top<n&&0<t.bottom&&lozadObserver&&lozadObserver.triggerLoad&&(lozadObserver.triggerLoad(e),console.log("Принудительная загрузка background-image для элемента:",e))})},1e3),console.log("Lozad initialized successfully"))}catch(e){console.error("Error in initLozad:",e)}}Fancybox.bind("[data-fancybox]",{theme:"light"}),document.addEventListener("DOMContentLoaded",function(){("undefined"!=typeof barba?initPageTransitions:(console.warn("Barba.js не найден"),initScript))()});let lenis;function initLenis(){try{var e;"undefined"==typeof Lenis?console.warn("Lenis не найден"):(lenis&&(lenis.destroy(),lenis=null),lenis=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),direction:"vertical",gestureDirection:"vertical",smooth:!0,mouseMultiplier:1,smoothTouch:!1,touchMultiplier:2,infinite:!1}),requestAnimationFrame(function e(t){lenis.raf(t),lozadObserver&&lozadObserver.observer&&document.querySelectorAll('.lozad:not([data-loaded="true"])').forEach(e=>{var t=e.getBoundingClientRect(),n=window.innerHeight;t.top<n+100&&-100<t.bottom?lozadObserver.triggerLoad&&lozadObserver.triggerLoad(e):lozadObserver.observer&&(lozadObserver.observer.unobserve(e),lozadObserver.observer.observe(e))}),requestAnimationFrame(e)}),0<(e=document.querySelectorAll('a[href^="#"]:not([href="#"])')).length&&e.forEach(e=>{e&&"function"==typeof e.addEventListener&&e.addEventListener("click",function(e){e.preventDefault();var e=e.target&&e.target.getAttribute?e.target.getAttribute("href"):null;e&&lenis&&(e=document.querySelector(e))&&lenis.scrollTo(e,{offset:0,duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e))})})}),console.log("Lenis initialized successfully"))}catch(e){console.error("Error in initLenis:",e)}}function initPageTransitions(){try{barba.hooks.before(()=>{window.scrollTo({top:0})}),barba.hooks.after(()=>{initLozad(),initImageScaleAnimation(),initWorksItemAnimation(),initTextAnimation(),initAnimNumbers();var e=document.querySelectorAll(".slider-block"),e=(0<e.length&&initSliderBlocks(e),document.querySelectorAll(".typecard__tab")),t=document.querySelectorAll(".typecard__content");0<e.length&&0<t.length&&initTypecardTabs(e,t)}),barba.init({sync:!1,debug:!1,timeout:7e3,transitions:[{name:"default",once({next:e}){updateBodyClass(e.html),initScript(),"undefined"!=typeof gsap&&gsap.from(e.container,{opacity:0,duration:.5,ease:"power1.out",clearProps:"all"})},async leave(e){try{if(e&&e.current&&e.current.container){if(initBarbaNavUpdate(e),"undefined"!=typeof gsap)return gsap.to(e.current.container,{opacity:0,duration:.5,ease:"power1.out",onComplete:()=>{e.current.container.remove()}});e.current.container.style.opacity="0",await delay(500),e.current.container.remove()}}catch(e){console.error("Error in leave transition:",e)}},async enter({next:t}){try{var e,n,r;if(updateBodyClass(t.html),t.container.style.opacity="0","undefined"!=typeof gsap)return(e=gsap.timeline()).to(t.container,{opacity:1,duration:.5,ease:"power1.out",clearProps:"opacity"}),n=t.container.querySelector(".header"),r=t.container.querySelector(".hero__title h1"),n&&e.to(n,{opacity:1,y:0,duration:.8,ease:"power2.out"},"-=0.3"),r&&e.to(r,{opacity:1,y:0,duration:.8,ease:"power2.out"},"-=0.5"),e;t.container.style.opacity="1"}catch(e){console.error("Error in enter transition:",e),t.container.style.opacity="1"}},async beforeEnter({next:e}){updateBodyClass(e.html),"undefined"!=typeof gsap&&(n=e.container.querySelector(".header"),t=e.container.querySelector(".hero__title h1"),n&&gsap.set(n,{opacity:0,y:-30}),t)&&gsap.set(t,{opacity:0,y:50});var t,n="div.wpcf7 > form";0<$(e.container).find(n).length&&$(n).each(function(){var e=$(this);wpcf7.init(e[0])}),initScript()}}]})}catch(e){console.error("Error in initPageTransitions:",e),initScript()}}function updateBodyClass(e){try{var t;e&&(t=e.match(/<body.+?class="([^"]*)"/i),document.body.setAttribute("class",t?t[1]:""))}catch(e){console.error("Error in updateBodyClass:",e)}}function delay(t=2e3){return new Promise(e=>setTimeout(e,t))}function initBarbaNavUpdate(e){try{if(e&&e.next&&e.next.html){const t=$(e.next.html).find("[data-barba-update]");0<t.length&&$("[data-barba-update]").each(function(e){0<$(t[e]).length&&(e=$(t[e]).attr("data-link-status"),$(this).attr("data-link-status",e))})}}catch(e){console.error("Error in initBarbaNavUpdate:",e)}}function initWindowInnerheight(){try{$(document).ready(()=>{var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")})}catch(e){console.error("Error in initWindowInnerheight:",e)}}function initImageScaleAnimation(){try{if("undefined"==typeof gsap)console.warn("GSAP не найден, анимация изображений отключена");else if("undefined"==typeof IntersectionObserver)console.warn("IntersectionObserver не поддерживается");else{var e=document.querySelectorAll(".hero img, .service__img img, .certs__gallery img");if(0!==e.length){gsap.set(e,{scale:1.4});const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(gsap.to(e.target,{scale:1,duration:1.2,ease:"power2.out"}),t.unobserve(e.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});e.forEach(e=>{t.observe(e)}),console.log("Image scale animation with GSAP initialized")}}}catch(e){console.error("Error in initImageScaleAnimation:",e)}}function initWorksItemAnimation(){try{if("undefined"==typeof gsap)console.warn("GSAP не найден, анимация works items отключена");else if("undefined"==typeof IntersectionObserver)console.warn("IntersectionObserver не поддерживается");else{var e=document.querySelectorAll(".works__item");if(0!==e.length){gsap.set(e,{opacity:0,y:50});const n=new IntersectionObserver(e=>{e.forEach(e=>{var t;e.isIntersecting&&(t=Array.from(document.querySelectorAll(".works__item")).indexOf(e.target),gsap.to(e.target,{opacity:1,y:0,duration:.6,ease:"power2.out",delay:t%2*.2}),n.unobserve(e.target))})},{threshold:.3,rootMargin:"0px 0px -50px 0px"});e.forEach(e=>{n.observe(e)}),console.log("Works items animation with GSAP initialized")}}}catch(e){console.error("Error in initWorksItemAnimation:",e)}}function initTextAnimation(){try{if("undefined"==typeof gsap)console.warn("GSAP не найден, анимация текста отключена");else if("undefined"==typeof IntersectionObserver)console.warn("IntersectionObserver не поддерживается");else{var e=document.querySelectorAll("h1, h2");if(0!==e.length){e.forEach(o=>{if(!o.hasAttribute("data-text-animated")){const i=o.textContent.trim().split(/\s+/),a=o.closest(".promo")&&"H2"===o.tagName;o.innerHTML="",i.forEach((e,t)=>{var n=document.createElement("span"),r=(n.style.cssText="display: inline-block; overflow: hidden; vertical-align: top;",a&&0===t&&(n.style.marginLeft="5vw"),document.createElement("span"));r.style.cssText="display: inline-block;",r.textContent=e,n.appendChild(r),o.appendChild(n),t<i.length-1&&o.appendChild(document.createTextNode(" "))}),o.setAttribute("data-text-animated","true");var e=o.querySelectorAll("span span");gsap.set(e,{y:"100%"})}});const n=new IntersectionObserver(e=>{e.forEach(e=>{var t;e.isIntersecting&&0!==(t=e.target.querySelectorAll("span span")).length&&(t.forEach((e,t)=>{gsap.to(e,{y:"0%",duration:.8,ease:"power2.out",delay:.05*t})}),n.unobserve(e.target))})},{threshold:.1,rootMargin:"0px 0px -30px 0px"});e.forEach(e=>{n.observe(e)}),console.log("Text animation with GSAP initialized")}}}catch(e){console.error("Error in initTextAnimation:",e)}}function initScript(){try{initLenis(),initLozad(),initBarbaNavUpdate(),initWindowInnerheight(),initImageScaleAnimation(),initWorksItemAnimation(),initTextAnimation(),console.log("Basic scripts initialized")}catch(e){console.error("Error in initScript:",e)}}